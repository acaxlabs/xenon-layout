<link rel="import" href="../polymer/polymer.html"/>
<dom-module id="xenon-field">
    <template>
        <style>
            label { font-size:12px; color:grey; font-family: Roboto, Noto, sans-serif; font-weight:400 }
            #container { margin: 12px 0px 8px 0px }
            #empty { color:gainsboro }
            #content { margin-top: 4px; }
            #content.xwrap { height: 1.2em; overflow: hidden; }
        </style>
        <div id="container">
            <label>{{label}}</label>
            <div id="empty" hidden>none</div>
            <div id="content">
                <content id="inside"></content>
            </div>
        </div>
    </template>
    <script>
    Polymer({
        is:"xenon-field",
        properties: {
            /* text label that floats above the content */
            label: String, 

            /* allow the content body to span more than one line, by default content is constrained */
            multiline: { type:Boolean, value:false, observer:"_multilineChange"}
        },
        ready: function () {
            var self = this;

            var observer = new MutationObserver(function (mutations) {
                mutations.forEach(function (mutation) {
                    var val = mutation.target.textContent;
                    var pat = /[a-zA-Z0-9]/;
                    self.$.empty.hidden = (pat.test(val));
                });
            });

            var config = { attributes: true, childList: true, characterData: true };

            var nodes = this.getEffectiveChildNodes();
            for (var i = 0; i < nodes.length; i++) {
                observer.observe(nodes[i], config);
                if (nodes[i].textContent != "") self.$.empty.hidden = true;
            }
        },
        _multilineChange: function (multiline) {
            this.toggleClass("xwrap", !multiline, this.$.content);
        }
    });
    </script>
</dom-module>
